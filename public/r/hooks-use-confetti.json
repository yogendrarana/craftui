{
	"$schema": "https://ui.shadcn.com/schema/registry-item.json",
	"name": "hooks-use-confetti",
	"type": "registry:hook",
	"description": "A hook to trigger confetti animation",
	"dependencies": [],
	"devDependencies": [],
	"registryDependencies": [],
	"files": [
		{
			"path": "src/registry/hooks/use-confetti/index.tsx",
			"content": "import { useCallback, useEffect, useRef } from \"react\";\n\nexport interface ConfettiOptions {\n  particleCount?: number;\n  origin?:\n    | \"top\"\n    | \"bottom\"\n    | \"left\"\n    | \"right\"\n    | \"center\"\n    | \"top-left\"\n    | \"top-right\"\n    | \"bottom-left\"\n    | \"bottom-right\";\n  duration?: number;\n}\n\ninterface Particle {\n  update: () => void;\n  render: (ctx: CanvasRenderingContext2D) => void;\n  position: { x: number; y: number };\n}\n\nconst gravityConfetti = 0.3;\nconst gravitySequins = 0.55;\nconst dragConfetti = 0.075;\nconst dragSequins = 0.02;\nconst terminalVelocity = 3;\n\nconst randomRange = (min: number, max: number) =>\n  Math.random() * (max - min) + min;\n\nconst randomColor = () => {\n  const r = Math.floor(Math.random() * 256);\n  const g = Math.floor(Math.random() * 256);\n  const b = Math.floor(Math.random() * 256);\n  return `rgb(${r},${g},${b})`;\n};\n\nconst initConfettoVelocity = (\n  xRange: [number, number],\n  yRange: [number, number]\n) => {\n  const x = randomRange(xRange[0], xRange[1]);\n  const range = yRange[1] - yRange[0] + 1;\n  let y =\n    yRange[1] -\n    Math.abs(randomRange(0, range) + randomRange(0, range) - range);\n  if (y >= yRange[1] - 1) {\n    y += Math.random() < 0.25 ? randomRange(1, 3) : 0;\n  }\n  return { x, y: -y };\n};\n\nfunction calculateOrigin(\n  canvasWidth: number,\n  canvasHeight: number,\n  origin?: ConfettiOptions[\"origin\"]\n) {\n  const originMap = {\n    center: {\n      x: [canvasWidth / 2 - 50, canvasWidth / 2 + 50],\n      y: [canvasHeight / 2 + 50, canvasHeight / 2 + 100],\n    },\n    top: { x: [canvasWidth / 2 - 50, canvasWidth / 2 + 50], y: [50, 100] },\n    bottom: {\n      x: [canvasWidth / 2 - 50, canvasWidth / 2 + 50],\n      y: [canvasHeight - 100, canvasHeight - 50],\n    },\n    left: { x: [50, 100], y: [canvasHeight / 2 - 50, canvasHeight / 2 + 50] },\n    right: {\n      x: [canvasWidth - 100, canvasWidth - 50],\n      y: [canvasHeight / 2 - 50, canvasHeight / 2 + 50],\n    },\n    \"top-left\": { x: [50, 100], y: [50, 100] },\n    \"top-right\": { x: [canvasWidth - 100, canvasWidth - 50], y: [50, 100] },\n    \"bottom-left\": { x: [50, 100], y: [canvasHeight - 100, canvasHeight - 50] },\n    \"bottom-right\": {\n      x: [canvasWidth - 100, canvasWidth - 50],\n      y: [canvasHeight - 100, canvasHeight - 50],\n    },\n  };\n\n  return originMap[origin || \"center\"];\n}\n\nfunction createConfetto(\n  canvasWidth: number,\n  canvasHeight: number,\n  origin?: ConfettiOptions[\"origin\"]\n): Particle {\n  const originBounds = calculateOrigin(canvasWidth, canvasHeight, origin);\n  const randomModifier = randomRange(0, 99);\n  const color = { front: randomColor(), back: randomColor() };\n\n  const dimensions = { x: randomRange(5, 9), y: randomRange(8, 15) };\n  const position = {\n    x: randomRange(originBounds.x[0], originBounds.x[1]),\n    y: randomRange(originBounds.y[0], originBounds.y[1]),\n  };\n\n  const rotation = randomRange(0, 2 * Math.PI);\n  const scale = { x: 1, y: 1 };\n  const velocity = initConfettoVelocity([-9, 9], [6, 11]);\n\n  return {\n    update() {\n      velocity.x -= velocity.x * dragConfetti;\n      velocity.y = Math.min(velocity.y + gravityConfetti, terminalVelocity);\n      velocity.x += Math.random() > 0.5 ? Math.random() : -Math.random();\n\n      position.x += velocity.x;\n      position.y += velocity.y;\n\n      scale.y = Math.cos((position.y + randomModifier) * 0.09);\n    },\n    render(ctx) {\n      const width = dimensions.x * scale.x;\n      const height = dimensions.y * scale.y;\n\n      ctx.save();\n      ctx.translate(position.x, position.y);\n      ctx.rotate(rotation);\n\n      ctx.fillStyle = scale.y > 0 ? color.front : color.back;\n      ctx.fillRect(-width / 2, -height / 2, width, height);\n\n      ctx.restore();\n    },\n    position,\n  };\n}\n\nfunction createSequin(\n  canvasWidth: number,\n  canvasHeight: number,\n  origin?: ConfettiOptions[\"origin\"]\n): Particle {\n  const originBounds = calculateOrigin(canvasWidth, canvasHeight, origin);\n  const color = randomColor();\n  const radius = randomRange(1, 2);\n\n  const position = {\n    x: randomRange(originBounds.x[0], originBounds.x[1]),\n    y: randomRange(originBounds.y[0], originBounds.y[1]),\n  };\n  const velocity = { x: randomRange(-6, 6), y: randomRange(-8, -12) };\n\n  return {\n    update() {\n      velocity.x -= velocity.x * dragSequins;\n      velocity.y += gravitySequins;\n\n      position.x += velocity.x;\n      position.y += velocity.y;\n    },\n    render(ctx) {\n      ctx.save();\n      ctx.translate(position.x, position.y);\n      ctx.fillStyle = color;\n      ctx.beginPath();\n      ctx.arc(0, 0, radius, 0, 2 * Math.PI);\n      ctx.fill();\n      ctx.restore();\n    },\n    position,\n  };\n}\n\n/* -------------------------------------------------- */\n/*                     HOOK START                     */\n/* -------------------------------------------------- */\n\nexport function useConfetti() {\n  const canvasRef = useRef<HTMLCanvasElement | null>(null);\n  const ctxRef = useRef<CanvasRenderingContext2D | null>(null);\n  const particlesRef = useRef<Particle[]>([]);\n  const frameRef = useRef<number | null>(null);\n\n  const createCanvas = () => {\n    if (typeof window === \"undefined\") return;\n\n    const canvas = document.createElement(\"canvas\");\n    canvas.style.position = \"fixed\";\n    canvas.style.top = \"0\";\n    canvas.style.left = \"0\";\n    canvas.style.pointerEvents = \"none\";\n    canvas.style.zIndex = \"9999\";\n\n    document.body.appendChild(canvas);\n    canvasRef.current = canvas;\n    ctxRef.current = canvas.getContext(\"2d\");\n\n    resizeCanvas();\n\n    window.addEventListener(\"resize\", resizeCanvas);\n  };\n\n  const resizeCanvas = () => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    canvas.width = window.innerWidth;\n    canvas.height = window.innerHeight;\n  };\n\n  const removeCanvas = () => {\n    const canvas = canvasRef.current;\n    if (canvas && canvas.parentNode) canvas.parentNode.removeChild(canvas);\n\n    if (frameRef.current) cancelAnimationFrame(frameRef.current);\n\n    canvasRef.current = null;\n    ctxRef.current = null;\n    particlesRef.current = [];\n    frameRef.current = null;\n  };\n\n  const render = () => {\n    const canvas = canvasRef.current;\n    const ctx = ctxRef.current;\n    if (!canvas || !ctx) return;\n\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    particlesRef.current.forEach((p) => {\n      p.update();\n      p.render(ctx);\n    });\n\n    particlesRef.current = particlesRef.current.filter(\n      (p) => p.position.y < canvas.height\n    );\n\n    if (particlesRef.current.length > 0) {\n      frameRef.current = requestAnimationFrame(render);\n    } else {\n      removeCanvas();\n    }\n  };\n\n  const triggerConfetti = useCallback(\n    (options: ConfettiOptions = {}) => {\n      const { particleCount = 50, origin = \"center\", duration = 3000 } = options;\n\n      if (!canvasRef.current) createCanvas();\n      if (!canvasRef.current || !ctxRef.current) return;\n\n      const canvas = canvasRef.current;\n\n      const confettiCount = Math.floor(particleCount * 0.75);\n      const sequinCount = Math.floor(particleCount * 0.25);\n\n      const newConfetti = Array.from({ length: confettiCount }, () =>\n        createConfetto(canvas.width, canvas.height, origin)\n      );\n      const newSequins = Array.from({ length: sequinCount }, () =>\n        createSequin(canvas.width, canvas.height, origin)\n      );\n\n      particlesRef.current.push(...newConfetti, ...newSequins);\n\n      if (!frameRef.current) {\n        frameRef.current = requestAnimationFrame(render);\n      }\n\n      setTimeout(() => {\n        if (particlesRef.current.length === 0) removeCanvas();\n      }, duration);\n    },\n    []\n  );\n\n  // Cleanup if component unmounts\n  useEffect(() => {\n    return () => removeCanvas();\n  }, []);\n\n  return triggerConfetti;\n}\n",
			"type": "registry:hook",
			"target": "hooks/use-confetti.tsx"
		}
	]
}
