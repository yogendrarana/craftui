{
	"$schema": "https://ui.shadcn.com/schema/registry-item.json",
	"name": "craftui-dialog",
	"description": "A raw implementation of dialog component",
	"dependencies": ["motion"],
	"registryDependencies": ["@craftdotui/utils"],
	"files": [
		{
			"path": "packages/craftui/components/dialog/index.tsx",
			"content": "\"use client\";\n\nimport React from \"react\";\nimport { X } from \"lucide-react\";\nimport { createPortal } from \"react-dom\";\nimport { AnimatePresence, motion } from \"motion/react\";\nimport type { Transition, Variants } from \"motion/react\";\n\nimport { cn } from \"@/lib/utils\";\n\n// dialog context\nconst DialogContext = React.createContext<{\n\tisOpen: boolean;\n\tsetIsOpen: (isOpen: boolean) => void;\n\ttitleId: string;\n\tdescriptionId: string;\n\tvariants: Variants;\n\ttransition: Transition;\n} | null>(null);\n\n// useDialog hook\nconst useDialog = () => {\n\tconst context = React.useContext(DialogContext);\n\tif (!context) {\n\t\tthrow new Error(\"Dialog components must be used within a Dialog\");\n\t}\n\treturn context;\n};\n\n/* -------------------------------------------------------------------------------------------------\n * Dialog (provider) component\n * -------------------------------------------------------------------------------------------------\n */\ninterface DialogProps {\n\tchildren: React.ReactNode;\n\tvariants?: Variants;\n\ttransition?: Transition;\n\tdefaultOpen?: boolean;\n\topen?: boolean;\n\tonOpenChange?: (isOpen: boolean) => void;\n}\n\nconst defaultVariants: Variants = {\n\tinitial: {\n\t\topacity: 0,\n\t\tscale: 0.95,\n\t},\n\tanimate: {\n\t\topacity: 1,\n\t\tscale: 1,\n\t},\n};\n\nconst defaultTransition: Transition = {\n\tease: \"easeOut\",\n\tduration: 0.2,\n};\n\nconst Dialog: React.FC<DialogProps> = ({\n\tchildren,\n\tvariants = defaultVariants,\n\ttransition = defaultTransition,\n\tdefaultOpen = false,\n\tonOpenChange,\n\topen,\n}) => {\n\tconst isControlled = open !== undefined;\n\tconst [uncontrolledOpen, setUncontrolledOpen] = React.useState(defaultOpen);\n\tconst isOpen = isControlled ? open : uncontrolledOpen;\n\n\tconst setIsOpen = React.useCallback(\n\t\t(newOpen: boolean) => {\n\t\t\tif (!isControlled) {\n\t\t\t\tsetUncontrolledOpen(newOpen);\n\t\t\t}\n\t\t\tonOpenChange?.(newOpen);\n\t\t},\n\t\t[isControlled, onOpenChange],\n\t);\n\n\tconst titleId = React.useRef(\n\t\t`dialog-title-${Math.random().toString(36).substring(2, 9)}`,\n\t).current;\n\tconst descriptionId = React.useRef(\n\t\t`dialog-description-${Math.random().toString(36).substring(2, 9)}`,\n\t).current;\n\n\tReact.useEffect(() => {\n\t\tonOpenChange?.(isOpen);\n\t}, [isOpen, onOpenChange]);\n\n\treturn (\n\t\t<DialogContext.Provider\n\t\t\tvalue={{\n\t\t\t\tisOpen,\n\t\t\t\tsetIsOpen,\n\t\t\t\ttitleId,\n\t\t\t\tdescriptionId,\n\t\t\t\tvariants,\n\t\t\t\ttransition,\n\t\t\t}}\n\t\t>\n\t\t\t{children}\n\t\t</DialogContext.Provider>\n\t);\n};\n\n/* -------------------------------------------------------------------------------------------------\n * DialogTrigger component\n * -------------------------------------------------------------------------------------------------\n */\ninterface DialogTriggerProps {\n\tchildren: React.ReactNode;\n\tasChild?: boolean;\n\tclassName?: string;\n}\n\nconst DialogTrigger: React.FC<DialogTriggerProps> = ({\n\tchildren,\n\tasChild = false,\n\tclassName,\n}) => {\n\tconst { setIsOpen } = useDialog();\n\n\tconst handleClick = (e: React.MouseEvent) => {\n\t\te.preventDefault();\n\t\tsetIsOpen(true);\n\t};\n\n\tif (asChild && React.isValidElement(children)) {\n\t\treturn React.cloneElement(children as React.ReactElement<any>, {\n\t\t\tonClick: (e: React.MouseEvent) => {\n\t\t\t\t(children as React.ReactElement<any>).props.onClick?.(e);\n\t\t\t\thandleClick(e);\n\t\t\t},\n\t\t});\n\t}\n\n\treturn (\n\t\t<button\n\t\t\ttype=\"button\"\n\t\t\tonClick={handleClick}\n\t\t\tclassName={cn(\n\t\t\t\t\"px-4 py-2 text-sm font-medium rounded-md border transition-colors focus:outline-none\",\n\t\t\t\t\"bg-white text-black border-gray-200 hover:bg-gray-200 focus:ring-2 focus:ring-gray-300\",\n\t\t\t\t\"dark:bg-zinc-800 dark:text-white dark:border-zinc-700 dark:hover:bg-gray-800 dark:focus:ring-gray-600\",\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t>\n\t\t\t{children}\n\t\t</button>\n\t);\n};\n\n/* -------------------------------------------------------------------------------------------------\n * DialogContent component\n * -------------------------------------------------------------------------------------------------\n */\ninterface DialogContentProps {\n\tchildren: React.ReactNode;\n\tonClose?: () => void;\n\tclassName?: string;\n\tbackdropClassName?: string;\n}\n\nconst DialogContent: React.FC<DialogContentProps> = ({\n\tchildren,\n\tonClose,\n\tclassName,\n\tbackdropClassName,\n}) => {\n\tconst { isOpen, setIsOpen, titleId, descriptionId, variants, transition } =\n\t\tuseDialog();\n\tconst contentRef = React.useRef<HTMLDivElement>(null);\n\tconst dialogRef = React.useRef<HTMLDivElement>(null);\n\n\tReact.useEffect(() => {\n\t\tconst handleEscape = (event: KeyboardEvent) => {\n\t\t\tif (event.key === \"Escape\") {\n\t\t\t\tsetIsOpen(false);\n\t\t\t\tonClose?.();\n\t\t\t}\n\t\t};\n\n\t\tif (isOpen) {\n\t\t\tdocument.addEventListener(\"keydown\", handleEscape);\n\t\t\treturn () => document.removeEventListener(\"keydown\", handleEscape);\n\t\t}\n\t}, [isOpen, setIsOpen, onClose]);\n\n\tReact.useEffect(() => {\n\t\tif (isOpen && contentRef.current) {\n\t\t\tconst focusableElements = Array.from(\n\t\t\t\tcontentRef.current.querySelectorAll(\n\t\t\t\t\t'button, [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex=\"-1\"])',\n\t\t\t\t),\n\t\t\t) as HTMLElement[];\n\n\t\t\tif (focusableElements.length > 0) {\n\t\t\t\tconst firstElement = focusableElements[0];\n\t\t\t\tconst lastElement =\n\t\t\t\t\tfocusableElements[focusableElements.length - 1];\n\n\t\t\t\tconst handleTabKey = (event: KeyboardEvent) => {\n\t\t\t\t\tif (event.key === \"Tab\") {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tevent.shiftKey &&\n\t\t\t\t\t\t\tdocument.activeElement === firstElement\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\tlastElement.focus();\n\t\t\t\t\t\t} else if (\n\t\t\t\t\t\t\t!event.shiftKey &&\n\t\t\t\t\t\t\tdocument.activeElement === lastElement\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\tfirstElement.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tfirstElement.focus();\n\n\t\t\t\tdocument.addEventListener(\"keydown\", handleTabKey);\n\t\t\t\treturn () =>\n\t\t\t\t\tdocument.removeEventListener(\"keydown\", handleTabKey);\n\t\t\t}\n\t\t}\n\t}, [isOpen]);\n\n\tconst portalContent = (\n\t\t<AnimatePresence>\n\t\t\t{isOpen && (\n\t\t\t\t<motion.div\n\t\t\t\t\tref={dialogRef}\n\t\t\t\t\tinitial={{ opacity: 0 }}\n\t\t\t\t\tanimate={{ opacity: 1 }}\n\t\t\t\t\texit={{ opacity: 0 }}\n\t\t\t\t\ttransition={{ duration: 0.2 }}\n\t\t\t\t\tvariants={variants}\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\"fixed inset-0 z-50 flex items-center justify-center overflow-y-auto\",\n\t\t\t\t\t\t\"bg-black/50 backdrop-blur-sm\",\n\t\t\t\t\t\tbackdropClassName,\n\t\t\t\t\t)}\n\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\tif (e.target === dialogRef.current) {\n\t\t\t\t\t\t\tsetIsOpen(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<motion.div\n\t\t\t\t\t\tref={contentRef}\n\t\t\t\t\t\tinitial=\"initial\"\n\t\t\t\t\t\tanimate=\"animate\"\n\t\t\t\t\t\texit=\"exit\"\n\t\t\t\t\t\ttransition={transition}\n\t\t\t\t\t\tvariants={variants}\n\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\"w-full max-w-lg mx-auto p-6 relative bg-white rounded-lg shadow-md\",\n\t\t\t\t\t\t\t\"dark:bg-zinc-800 dark:shadow-lg\",\n\t\t\t\t\t\t\tclassName,\n\t\t\t\t\t\t)}\n\t\t\t\t\t\trole=\"dialog\"\n\t\t\t\t\t\taria-modal=\"true\"\n\t\t\t\t\t\taria-labelledby={titleId}\n\t\t\t\t\t\taria-describedby={descriptionId}\n\t\t\t\t\t>\n\t\t\t\t\t\t{children}\n\t\t\t\t\t</motion.div>\n\t\t\t\t</motion.div>\n\t\t\t)}\n\t\t</AnimatePresence>\n\t);\n\n\treturn typeof window !== \"undefined\"\n\t\t? createPortal(portalContent, document.body)\n\t\t: null;\n};\n\n/* -------------------------------------------------------------------------------------------------\n * DialogHeader component\n * -------------------------------------------------------------------------------------------------\n */\nconst DialogHeader: React.FC<{\n\tchildren: React.ReactNode;\n\tclassName?: string;\n}> = ({ children, className }) => (\n\t<div className={cn(\"mb-4\", className)}>{children}</div>\n);\n\n/* -------------------------------------------------------------------------------------------------\n * DialogTitle component\n * -------------------------------------------------------------------------------------------------\n */\nconst DialogTitle: React.FC<{\n\tchildren: React.ReactNode;\n\tclassName?: string;\n}> = ({ children, className }) => {\n\tconst { titleId } = useDialog();\n\treturn (\n\t\t<h2\n\t\t\tid={titleId}\n\t\t\tclassName={cn(\"text-xl font-semibold dark:text-white\", className)}\n\t\t>\n\t\t\t{children}\n\t\t</h2>\n\t);\n};\n\n/* -------------------------------------------------------------------------------------------------\n * DialogDscription component\n * -------------------------------------------------------------------------------------------------\n */\nconst DialogDescription: React.FC<{\n\tchildren: React.ReactNode;\n\tclassName?: string;\n}> = ({ children, className }) => {\n\tconst { descriptionId } = useDialog();\n\treturn (\n\t\t<p\n\t\t\tid={descriptionId}\n\t\t\tclassName={cn(\n\t\t\t\t\"text-sm text-gray-400 dark:text-gray-500\",\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t>\n\t\t\t{children}\n\t\t</p>\n\t);\n};\n\n/* -------------------------------------------------------------------------------------------------\n * DialogClose component\n * -------------------------------------------------------------------------------------------------\n */\ninterface DialogCloseProps {\n\tchildren?: React.ReactNode;\n\tasChild?: boolean;\n\tclassName?: string;\n}\n\nconst DialogClose: React.FC<DialogCloseProps> = ({\n\tchildren,\n\tasChild = false,\n\tclassName,\n}) => {\n\tconst { setIsOpen } = useDialog();\n\n\tconst handleClose = (e: React.MouseEvent) => {\n\t\te.preventDefault();\n\t\tsetIsOpen(false);\n\t};\n\n\tif (asChild && React.isValidElement(children)) {\n\t\treturn React.cloneElement(children as React.ReactElement<any>, {\n\t\t\tonClick: (e: React.MouseEvent) => {\n\t\t\t\t(children as React.ReactElement<any>).props.onClick?.(e);\n\t\t\t\thandleClose(e);\n\t\t\t},\n\t\t});\n\t}\n\n\treturn (\n\t\t<button\n\t\t\ttype=\"button\"\n\t\t\tonClick={handleClose}\n\t\t\tclassName={cn(\n\t\t\t\t\"text-sm border border-gray-200 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-100\",\n\t\t\t\t\"dark:text-gray-300 dark:border-zinc-700 dark:hover:text-white dark:hover:bg-gray-800 dark:focus:ring-zinc-800\",\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t>\n\t\t\t{children || <X className=\"h-4 w-4\" />}\n\t\t</button>\n\t);\n};\n\nexport {\n\tDialog,\n\tDialogTrigger,\n\tDialogHeader,\n\tDialogContent,\n\tDialogTitle,\n\tDialogDescription,\n\tDialogClose,\n\tuseDialog,\n};\n",
			"type": "registry:component",
			"target": "components/craftui/components/dialog.tsx"
		}
	],
	"type": "registry:component"
}
